(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a807dc02"],{"29ce":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-table",{attrs:{size:"small",columns:e.columns,"data-source":e.data?e.data:[],loading:e.tableLoading,pagination:!1,rowKey:function(e){return e["index"]}},scopedSlots:e._u([{key:"FJLIST",fn:function(t,l){return[l.FJLIST.length>0?[e._l(l.FJLIST,(function(t,l){return[a("div",{key:l},[a("a",{attrs:{href:t.FJURL,target:"_blank"}},[e._v(e._s(t.FJNAME||"-"))])])]}))]:a("div",[e._v("-")])]}}])}),a("a-modal",{attrs:{title:e.modalData.title,maskClosable:!1,width:"582px",size:"small",footer:null},on:{ok:e.handleClztOk,cancel:e.handleClztCancle},model:{value:e.clztVisible,callback:function(t){e.clztVisible=t},expression:"clztVisible"}},[a("a-spin",{attrs:{spinning:e.modalSpinning,tip:"加载中..."}},[e.modalData["descArray"]&&e.modalData["descArray"].length>0?a("a-descriptions",{attrs:{title:"",size:"small",bordered:""}},[e._l(e.modalData["descArray"],(function(t,l){return["XGFJ"!=t["key"]&&"CLBG"!=t["key"]?a("a-descriptions-item",{key:l,attrs:{span:t["span"],label:t["label"]}},[e._v(e._s(t["value"]||"-"))]):e._e(),"XGFJ"==t["key"]?a("a-descriptions-item",{key:l,attrs:{span:t["span"],label:t["label"]}},e._l(t.value,(function(t,l){return a("p",{key:l},[a("a",{attrs:{type:"link",href:t.FJLJ,target:"_blank"}},[e._v(e._s(l+1)+"、"+e._s(t.FJMC))])])})),0):e._e(),"CLBG"==t["key"]?a("a-descriptions-item",{key:l,attrs:{span:t["span"],label:t["label"]}},e._l(t.value,(function(t,l){return a("p",{key:l},[a("span",[e._v(e._s(l+1)+"、"+e._s(t.FJMC))]),a("a-button",{attrs:{size:"small",type:"link",icon:"download",href:t.FJLJ,target:"_blank"}},[e._v("下载")])],1)})),0):e._e()]}))],2):a("a-empty")],1)],1),a("a-modal",{attrs:{title:e.clbgData.title,maskClosable:!1,width:"582px",size:"small"},on:{ok:e.handleClbgOk,cancel:e.handleClbgCancle},model:{value:e.clbgVisible,callback:function(t){e.clbgVisible=t},expression:"clbgVisible"}},[a("a-descriptions",{attrs:{title:"",size:"small",bordered:""}},[a("a-descriptions-item",{key:"1",attrs:{span:"3",label:"工程名称"}},[e._v(e._s(e.clbgObjArr.GCMC))]),a("a-descriptions-item",{key:"2",attrs:{span:"3",label:"工规证号"}},[e._v(e._s(e.clbgObjArr.GCBH))]),a("a-descriptions-item",{key:"3",attrs:{span:"3",label:"测量事项"}},[e._v(e._s(e.clbgObjArr.CLSX))]),a("a-descriptions-item",{key:"4",attrs:{span:"3",label:"测绘单位"}},[e._v(e._s(e.clbgObjArr.CHDW))]),a("a-descriptions-item",{key:"5",attrs:{span:"3",label:"建设单位"}},[e._v(e._s(e.clbgObjArr.WTDW))]),a("a-descriptions-item",{key:"6",attrs:{span:"3",label:"联系人"}},[e._v(e._s(e.clbgObjArr.LXR))]),a("a-descriptions-item",{key:"7",attrs:{span:"3",label:"联系电话"}},[a("a-row",[a("a-col",{attrs:{span:"8"}},[a("span",[e._v(e._s(e.clbgObjArr.LXDH))])]),a("a-col",{attrs:{span:"14"}},[a("a-input",{model:{value:e.captcha,callback:function(t){e.captcha=t},expression:"captcha"}},[a("a-button",{attrs:{slot:"addonAfter",size:"small",type:"link",disabled:e.state.smsSendBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha(t)}},slot:"addonAfter"},[e._v(e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码"))])],1)],1)],1)],1),a("a-descriptions-item",{key:"8",attrs:{span:"3",label:""}},[e._l(e.clbgObjArr.CLBGFJ,(function(t,l){return[a("span",{key:l,staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.FJNAME))]),a("a",{key:l+Math.random(),attrs:{type:"link",target:"_blank",href:t.FJURL}},[e._v("下载")]),a("br",{key:l+Math.random()})]}))],2)],1)],1),a("a-modal",{attrs:{title:e.clbgfjData.title,maskClosable:!1,width:"582px",size:"small",footer:null},on:{ok:e.handleClbgfjOk,cancel:e.handleClbgfjCancle},model:{value:e.clbgfjVisible,callback:function(t){e.clbgfjVisible=t},expression:"clbgfjVisible"}},[a("div",{staticClass:"clbgfj",attrs:{id:"clbgfj"}},[a("a-descriptions",{attrs:{title:"",size:"small",bordered:""}},[e.clbgfjData["descArray"]&&e.clbgfjData["descArray"].length>0?[e._l(e.clbgfjData["descArray"],(function(t,l){return[a("a-descriptions-item",{key:l,attrs:{span:"3",label:t.label}},[a("a",{attrs:{href:t.value,target:"_blank"}},[e._v("下载")])])]}))]:e._e()],2)],1)])],1)},n=[],s=(a("4de4"),a("d81d"),a("45fc"),a("5530")),i={name:"BusiTable",components:{},props:{tableData:{default:function(){},type:Object,required:!0}},data:function(){return{data:[],columns:[],tableLoading:!1,clztVisible:!1,clbgVisible:!1,clbgfjVisible:!1,modalData:{title:"",descArray:[]},clbgData:{title:"确认测量报告",descArray:[]},clbgfjData:{title:"查看测量报告",descArray:[]},clbgObjArr:{},modalSpinning:!1,tableId:"",tableCLSX:"",tableChdw:"",captcha:null,state:{smsSendBtn:!1,time:60}}},computed:{},watch:{tableData:function(e,t){this._.isEmpty(e)||(this.tableLoading=!0,this.columns=this.getTableColumn(this.tableData),this.data=this.getTableData(this.tableData),this.tableLoading=!1)}},created:function(){},mounted:function(){this.columns=this.getTableColumn(this.tableData),this.data=this.getTableData(this.tableData)},inject:["reload"],methods:{getTableColumn:function(e){if(this._.isEmpty(e))return{};var t=e.columns,a=e.hideColumns,l=t.filter((function(e){return!a.some((function(t){return t===e.key}))})),n=l.map((function(e,t){return"FJLIST"===e.key?{dataIndex:e["key"],key:e["key"],title:e["label"],scopedSlots:{customRender:e["key"]},width:350}:"XH"===e.key?{dataIndex:e["key"],key:e["key"],title:e["label"],scopedSlots:{customRender:e["key"]},width:50}:{dataIndex:e["key"],key:e["key"],title:e["label"],scopedSlots:{customRender:e["key"]}}}));return n},getTableData:function(e){var t=[];if(this._.isEmpty(e))t=[];else{var a=e.rowsList;t=a.map((function(e,t){var a=[],l=[],n=[];for(var i in e)"names"===i&&(a=e[i]),"urls"===i&&(l=e[i]);return a.map((function(e,t){n.push({name:e,url:l[t]})})),Object(s["a"])(Object(s["a"])({},e),{},{index:t})}))}return t},GetPauseReason:function(){var e=this;this.modalSpinning=!0,this.$WebApi.busiProcess["GetPauseReason"]({table001id:this.tableId,clsx:this.tableCLSX}).then((function(t){var a=t;e._.isEmpty(a)||(e.modalData=e.handlePauseReason(a)),e.modalSpinning=!1})).catch((function(t){e.modalSpinning=!1}))},GetSurveyCompanyInfo:function(){var e=this;this.modalSpinning=!0,this.$WebApi.busiProcess["GetSurveyCompanyInfo"]({chdw:this.tableChdw}).then((function(t){var a=t;e._.isEmpty(a)||(e.modalData=e.handleSurveyCompanyInfo(a)),e.modalSpinning=!1})).catch((function(t){e.modalSpinning=!1}))},GetSurveyReport:function(){var e=this;this.modalSpinning=!0,this.$WebApi.busiProcess["GetSurveyReport"]({table008id:this.tableId}).then((function(t){var a=t;e._.isEmpty(a)||(e.modalData=e.handleSurveyReport(a)),e.modalSpinning=!1})).catch((function(t){e.modalSpinning=!1}))},handleSurveyReport:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&("CHDW"===a&&t.push({label:"测绘单位",value:e[a],key:a,span:3}),"CLBG"===a&&t.push({label:"测量报告",value:e[a],key:a,span:3}),"CLSX"===a&&t.push({label:"测量事项",value:e[a],key:a,span:3}),"SCSJ"===a&&t.push({label:"上传时间",value:e[a],key:a,span:3}));return{title:"查看测量报告",descArray:t}},handleSurveyCompanyInfo:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&("DWDZ"===a&&t.push({label:"单位地址",value:e[a],key:a,span:3}),"DWMC"===a&&t.push({label:"单位名称",value:e[a],key:a,span:3}),"LXDH"===a&&t.push({label:"联系电话",value:e[a],key:a,span:3}),"LXR"===a&&t.push({label:"联系人",value:e[a],key:a,span:3}));return{title:"测绘服务机构信息",descArray:t}},handlePauseReason:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&("CLDW"===a&&t.push({label:"测绘单位",value:e[a],key:a,span:3}),"CLSX"===a&&t.push({label:"测量事项",value:e[a],key:a,span:3}),"LJYZT"===a&&t.push({label:"累计已暂停",value:e[a],key:a,span:3}),"XGFJ"===a&&t.push({label:"相关附件",value:e[a],key:a,span:3}),"ZTSJ"===a&&t.push({label:"暂停时间",value:e[a],key:a,span:3}),"ZTYY"===a&&t.push({label:"暂停原因",value:e[a],key:a,span:3}));return{title:"查看暂停原因",descArray:t}},handleWhy:function(e){this.tableId=e["TABLE001ID"],this.tableCLSX=e["CLSX"],this.GetPauseReason(),this.clztVisible=!0},handleGroupMore:function(e){this.tableChdw=e["CHDW"],this.GetSurveyCompanyInfo(),this.clztVisible=!0},handleQueryReport:function(e){this.tableId=e["TABLE008ID"],this.GetSurveyReport(),this.clbgObjArr=e,this.clbgVisible=!0},handleClztOk:function(){this.clztVisible=!1},handleClztCancle:function(){this.clztVisible=!1},handleClbgOk:function(){var e=this,t=this.clbgObjArr.CLSX,a=this.clbgObjArr.LXDH,l=this.clbgObjArr.TABLE001ID,n=this.captcha;this._.isEmpty(n)?this.$message.warning("请输入验证码！"):(this.$WebApi.busiProcess["QueryProgress"]({clsx:t,lxdh:a,table001id:l,captcha:n}).then((function(t){t.code&&998===t.code?e.$message.warning(t.desc):(e.$message.success("您已成功确认！"),e.reload())})).catch((function(t){e.$message.error("您确认操作失败！")})),this.clbgVisible=!1)},handleClbgCancle:function(){this.clbgVisible=!1},getCaptcha:function(e){var t=this;e.preventDefault(),this.$WebApi.user["SendVerification"]({sPhoneNum:this.clbgObjArr.LXDH}).then((function(e){t.state.smsSendBtn=!0,"短信发送失败！"===e?t.$message.error("短信发送失败!60秒后再验证"):t.$message.success("短信发送成功!");var a=window.setInterval((function(){t.state.time--<=0&&(t.state.time=60,t.state.smsSendBtn=!1,window.clearInterval(a))}),1e3)})).catch((function(e){}))},handleClbgfjOk:function(){this.clbgfjVisible=!1},handleClbgfjCancle:function(){this.clbgfjVisible=!1},handleQueryCL:function(e){var t=e.map((function(e,t){return{label:e.FJNAME,value:e.FJURL}}));this.$set(this.clbgfjData,"descArray",t),this.clbgfjVisible=!0}}},r=i,c=(a("908c"),a("2877")),o=Object(c["a"])(r,l,n,!1,null,"51ba3ee0",null);t["default"]=o.exports},"908c":function(e,t,a){"use strict";a("eeef")},eeef:function(e,t,a){}}]);