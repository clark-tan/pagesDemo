(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["preBusiness","chunk-10051558"],{1233:function(t,e,a){},"269b":function(t,e,a){"use strict";a("bbf3")},"2aef":function(t,e,a){"use strict";a("1233")},"2c2e":function(t,e,a){"use strict";a("b456")},"2cf0":function(t,e,a){},"3a85":function(t,e,a){"use strict";a("9aba")},"755f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"protocol"},[a("a-spin",{attrs:{spinning:t.spinning,delay:t.delayTime}},[a("div",{staticClass:"top"},[a("div",{staticClass:"DKBT"},[t._v(t._s(t.protocolRowslist.DKBT))]),a("div",{staticClass:"DYBFSM suojin"},[t._v(t._s(t.protocolRowslist.DYBFSM))]),a("div",{staticClass:"DEBFSMBT"},[t._v(t._s(t.protocolRowslist.DEBFSMBT)+"：")]),a("div",{staticClass:"DSBFSM"},[a("a-icon",{attrs:{type:"info-circle"}}),t._v(" "+t._s(t.protocolRowslist.DSBFSM))],1)]),a("div",{staticClass:"content",style:{maxHeight:t.clientHeight?t.clientHeight-250+"px":"100%"}},[a("div",{staticClass:"CXTABLE1 suojin"},[a("a-list",{attrs:{bordered:"","data-source":t.protocolRowslist.CXTABLE1},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[t._v(" "+t._s(e.value)+" ")])}}])})],1)]),a("div",{staticClass:"footer"},[a("div",[a("a-checkbox",{on:{change:t.onChange}},[t._v(" "+t._s(t.protocolRowslist.GXKWZ)+" ")])],1),a("div",{staticClass:"button"},[a("a-button",{attrs:{disabled:!(t.isChecked&&t.numTime<=0)},on:{click:t.handleYY}},[t._v("我要预约业务 "),t.numTime>0?[t._v("("+t._s(t.numTime)+"s)")]:t._e()],2)],1)])])],1)},n=[],i=a("ed08"),o={name:"ShowProtocol",components:{},props:{},data:function(){return{clientHeight:null,protocolData:"",protocolRowslist:[],isChecked:!1,spinning:!1,delayTime:0,numTime:5}},computed:{},watch:{},created:function(){},mounted:function(){this.GetEntrustDesc(),this.changeNum(),this.clientHeight=this.$parent.$el.clientHeight},methods:{GetEntrustDesc:function(){var t=this;this.spinning=!0,this.$WebApi.preBusiness["GetEntrustDesc"]().then((function(e){t.protocolRowslist=e.rowsList[0],t.protocolData=i["b"].table2Desc(e)})).catch((function(t){})).then((function(){t.spinning=!1}))},onChange:function(t){this.isChecked=t.target.checked},handleYY:function(){this.$emit("currentStepOK",{componentName:"ShowProtocol",num:1})},changeNum:function(){var t=this;setInterval((function(){if(!(t.numTime>0))return!1;t.numTime--}),1e3)}}},r=o,c=(a("269b"),a("2877")),l=Object(c["a"])(r,s,n,!1,null,"55901810",null);e["default"]=l.exports},"82da":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"FileTable"},[a("div",{staticClass:"content"},[a("upload-table",{ref:"uploadTable",attrs:{tableData:t.tableData,disabled:!1}})],1),a("div",{staticClass:"footer"},[a("div",{staticClass:"my-button"},[t._.isEmpty(t.permission.isTemporarySave)&&!0===t.permission.isTemporarySave?[a("a-button",{attrs:{type:"primary"},on:{click:t.saveCurrentData}},[t._v("暂存")])]:t._e(),a("a-button",{on:{click:function(e){return t.handleTableData(-1)}}},[t._v("上一步")]),a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleTableData(1)}}},[t._v(t._s(t.isLast?"提交申请":"下一步"))])],2)])])},n=[],i=(a("a15b"),a("d81d"),a("4c6d")),o={name:"FileTable",components:{"upload-table":i["default"]},props:{isLast:{default:!1,type:Boolean,required:!0},permission:{default:function(){},type:Object,required:!0},remoteData:{default:function(){},type:Object,required:!1}},data:function(){return{tableData:{columns:[],hideColumns:[],rowsList:[]},submitData:[]}},computed:{},watch:{remoteData:{handler:function(t,e){},immediate:!0,deep:!0},"$store.state.preBusniess.HandlePreBusniessState":function(){var t=this.$store.state.preBusniess.SaveData;if(t){var e=t["saveData"],a=t["ischange"];if(e&&e.length>0){var s=[];e.map((function(t,e){if(t.clsx&&t.clsx.length>0){var a=t.clsx[t.clsx.length-1];Window._.isEmpty(a)||s.push(a)}})),this.GetProvideFileList(s.join(";"),a)}}}},mounted:function(){},methods:{GetProvideFileList:function(t,e){var a=this;this.$WebApi.preBusiness["GetProvideFileList"]({sWTSX:t}).then((function(t){t["rowsList"]&&t["rowsList"].length>0&&(a.tableData=t,e||a.$set(a.tableData,"rowsList",a.remoteData.files))})).catch((function(t){}))},handleTableData:function(t){1===t?this.isEnableSubmit()&&this.$emit("currentStepOK",{componentName:"OtherTable",num:t}):this.$emit("currentStepOK",{componentName:"OtherTable",num:t})},isEnableSubmit:function(){var t=!0;return this.$refs.uploadTable.isAllSubmit(!0)||(t=!1),t||this.$message.error("材料上传失败"),t},getSubmitData:function(){return{files:this.$refs.uploadTable.getSubmitData()}},saveCurrentData:function(){this.$emit("saveAllData")},fillData2form:function(t){}}},r=o,c=(a("3a85"),a("2877")),l=Object(c["a"])(r,s,n,!1,null,"77d0fd88",null);e["default"]=l.exports},8589:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[!1===t.isReload?["sync"===t.submitStatus?a("a-result",{attrs:{title:"预约提交中..."},scopedSlots:t._u([{key:"icon",fn:function(){return[a("a-icon",{attrs:{type:"sync",spin:""}})]},proxy:!0}],null,!1,1235788773)}):t._e(),"success"===t.submitStatus?a("a-result",{attrs:{status:"success",title:"您提交成功","sub-title":""}}):t._e(),"error"===t.submitStatus?a("a-result",{attrs:{status:"error",title:"您提交失败","sub-title":""}}):t._e(),"sync"!=t.submitStatus?a("div",{staticStyle:{"text-align":"center"}},[a("a-row",{attrs:{gutter:4,type:"flex",justify:"center",align:"middle"}},[a("a-col",{attrs:{span:4}},[a("a-button",{attrs:{type:"primary"},on:{click:t.hadleRefresh}},[t._v("继续申请")])],1),a("a-col",{attrs:{span:4}},[a("a-button",{attrs:{type:"primary"},on:{click:t.handleQueryMore}},[t._v("查看申请详情")])],1)],1)],1):t._e()]:t._e()],2)},n=[],i=a("ed08"),o={name:"Result",components:{},props:{submitStatus:{default:"sync",type:String,required:!0}},data:function(){return{isReload:!1}},computed:{},watch:{submitStatus:function(t,e){var a=this;this.isReload=!0,this.$nextTick((function(){a.isReload=!1}))}},created:function(){this.handleSubmit()},methods:{handleQueryMore:function(){this.$router.push({name:"businessProcess",params:{hasRefresh:!0}})},hadleRefresh:function(){var t=this;i["a"].reloadComponent(t)},handleSubmit:function(){this.$emit("submitAllData")}}},r=o,c=a("2877"),l=Object(c["a"])(r,s,n,!1,null,"2764ffe7",null);e["default"]=l.exports},"984a":function(t,e,a){"use strict";a("2cf0")},"9aba":function(t,e,a){},b456:function(t,e,a){},bbf3:function(t,e,a){},ce30:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-layout",{staticClass:"preBusinessLayout"},[a("a-layout-header",{staticClass:"pageHeader"},[a("a-steps",{attrs:{current:t.current,size:"small"}},t._l(t.processData,(function(t,e){return a("a-step",{key:e,attrs:{title:t.componentDesc}})})),1)],1),a("a-layout-content",{staticClass:"content"},[a("ShowProtocol",{directives:[{name:"show",rawName:"v-show",value:"ShowProtocol"===t.currentComponentName,expression:"currentComponentName === 'ShowProtocol'"}],ref:"showProtocol",attrs:{isLast:t.componentNameArray.indexOf("ShowProtocol")===t.componentNameArray.length-2,permission:t.permissions.ShowProtocol},on:{currentStepOK:t.handleCurrentStepOK,saveAllData:t.saveAllData}}),t.componentReFresh.commonForm?a("CommonFormFinal",{directives:[{name:"show",rawName:"v-show",value:"CommonFormFinal"===t.currentComponentName,expression:"currentComponentName === 'CommonFormFinal'"}],ref:"commonForm",attrs:{isLast:t.componentNameArray.indexOf("CommonFormFinal")===t.componentNameArray.length-2,remoteData:t.componentNameArray.indexOf("CommonFormFinal")>-1?t.processData[t.componentNameArray.indexOf("CommonFormFinal")]["data"]:{},permission:t.permissions.CommonFormFinal},on:{currentStepOK:t.handleCurrentStepOK,saveAllData:t.saveAllData}}):t._e(),a("FileTable",{directives:[{name:"show",rawName:"v-show",value:"FileTable"===t.currentComponentName,expression:"currentComponentName === 'FileTable'"}],ref:"fileTable",attrs:{isLast:t.componentNameArray.indexOf("FileTable")===t.componentNameArray.length-2,remoteData:t.componentNameArray.indexOf("FileTable")>-1?t.processData[t.componentNameArray.indexOf("FileTable")]["data"]:{},permission:t.permissions.FileTable},on:{currentStepOK:t.handleCurrentStepOK,saveAllData:t.saveAllData}}),a("CascaderSelect",{directives:[{name:"show",rawName:"v-show",value:"CascaderSelect"===t.currentComponentName,expression:"currentComponentName === 'CascaderSelect'"}],ref:"cascaderSelect",attrs:{isLast:t.componentNameArray.indexOf("CascaderSelect")===t.componentNameArray.length-2,remoteData:t.componentNameArray.indexOf("CascaderSelect")>-1?t.processData[t.componentNameArray.indexOf("CascaderSelect")]["data"]:{},permission:t.permissions.CascaderSelect},on:{currentStepOK:t.handleCurrentStepOK,saveAllData:t.saveAllData}}),a("OtherTable",{directives:[{name:"show",rawName:"v-show",value:"OtherTable"===t.currentComponentName,expression:"currentComponentName === 'OtherTable'"}],ref:"otherTable",attrs:{isLast:t.componentNameArray.indexOf("OtherTable")===t.componentNameArray.length-2,remoteData:t.componentNameArray.indexOf("OtherTable")>-1?t.processData[t.componentNameArray.indexOf("OtherTable")]["data"]:{},permission:t.permissions.OtherTable},on:{currentStepOK:t.handleCurrentStepOK,saveAllData:t.saveAllData}}),"Result"===t.currentComponentName?a("Result",{ref:"result",attrs:{isLast:t.componentNameArray.indexOf("Result")===t.componentNameArray.length-2,submitStatus:t.submitStatus,permission:t.permissions.Result},on:{currentStepOK:t.handleCurrentStepOK,submitAllData:t.submitAllData}}):t._e()],1)],1)},n=[],i=(a("c975"),a("d81d"),a("fb6a"),a("5530")),o=a("ba93"),r=a("2f62"),c=a("ed08"),l=a("755f"),u=a("a0b5"),m=a("82da"),h=a("fd19"),p=a("d571"),d=a("8589"),f={name:"PreBusiness",components:{CommonFormFinal:u["default"],CascaderSelect:h["default"],FileTable:m["default"],ShowProtocol:l["default"],OtherTable:p["default"],Result:d["default"]},props:{},data:function(){return{lightApi:o["a"],pageHeight:0,stepData:{current:0,steps:[{title:"申请表单"},{title:"结果"}]},docunid:"",saveData:{},current:0,permissions:{ShowProtocol:{},CommonFormFinal:{},CascaderSelect:{},FileTable:{},OtherTable:{},Result:{}},componentReFresh:{commonForm:!0},currentComponentName:"",currentComponentDesc:"",processData:[{componentDesc:"预约协议",componentName:"ShowProtocol",data:{}},{componentDesc:"预约基础表",componentName:"CommonFormFinal",permission:{REC_GCMC:{isShow:!0,isCheck:!0},REC_GCBH:{isShow:!0,isCheck:!0},REC_JSXZ:{isShow:!0,isCheck:!0},REC_TDLY:{isShow:!0,isCheck:!0},REC_XZQ:{isShow:!0,isCheck:!0},REC_GCXXDD:{isShow:!0,isCheck:!0},REC_WTDW:{isShow:!0,isCheck:!0},REC_LXR:{isShow:!0,isCheck:!0},REC_LXFS:{isShow:!0,isCheck:!0},REC_DZYX:{isShow:!0,isCheck:!0},REC_QJFS:{isShow:!0,isCheck:!0},REC_SJDZ:{isShow:!0,isCheck:!0},REC_SJR:{isShow:!0,isCheck:!0},REC_SJDH:{isShow:!0,isCheck:!0}},data:{}},{componentDesc:"测量事项",componentName:"CascaderSelect",data:{}},{componentDesc:"材料上传",componentName:"FileTable",data:{}},{componentDesc:"委托书",componentName:"OtherTable",data:{}},{componentDesc:"预约提交",componentName:"Result",data:{}}],componentNameArray:[],submitStatus:"sync",isSaveSuccess:!0,saveDataID:null}},computed:Object(i["a"])({},Object(r["c"])({user:"userInfo"})),watch:{},created:function(){this.pageHeight=window.innerHeight},mounted:function(){this.docunid=this.$route.params.docunid,this._.isEmpty(this.user)||this._.isEmpty(this.docunid)?this.GetComponentConfig():this.GetDataByTemporarilyToCode()},updated:function(){},methods:Object(i["a"])(Object(i["a"])({},Object(r["b"])(["setPageNum","setDocunid"])),{},{GetComponentConfig:function(){var t=this;this.$WebApi.preBusiness["GetComponentConfig"]().then((function(e){e&&e.length>0&&(t.currentComponentName=e[0].componentName,t.currentComponentDesc=e[0].componentDesc,t.processData=e,t.getComponentName(e))})).catch((function(t){}))},handleProcessData:function(t){var e=this;t&&t.length>0&&t.map((function(t,a){t.permission&&!Window._.isEmpty(t.permission)&&e.componentNameArray.indexOf(t.componentName)>-1&&(e.permissions[t.componentName]=t.permission,e.componentReFresh[t.componentName]=!1,e.$nextTick((function(){e.componentReFresh[t.componentName]=!0})))}))},GetDataByTemporarilyToCode:function(){var t=this;this.$WebApi.preBusiness["GetDataByTemporarilyToCode"]({rid:this.docunid}).then((function(e){var a=JSON.parse(e.content);a[a.length-1].currentComponentName&&a[a.length-1].currentComponentDesc?(t.currentComponentName=a[a.length-1].currentComponentName,t.currentComponentDesc=a[a.length-1].currentComponentDesc,t.current=a[a.length-1].current):(t.currentComponentName=a[0].componentName,t.currentComponentDesc=a[0].componentDesc),t.processData=a.slice(0,a.length-1),t.getComponentName(a.slice(0,a.length-1))})).catch((function(t){}))},GetPersonAppointmentDetail:function(t){var e=this;this.$WebApi.busiProcess["GetPersonAppointmentDetail"]({sRID:this.docunid}).then((function(t){var a={};e.saveData=t.rowsList[0],a.REC_DZYX=e.saveData.DZYX,a.REC_GCMC=e.saveData.GCMC,a.REC_GCXXDD=e.saveData.GCXXDD,a.REC_GCBH=e.saveData.GGZH,a.REC_WTDW=e.saveData.JSDW,a.REC_JSXZ=e.saveData.JSXZ,a.REC_LXFS=e.saveData.LXDH,a.REC_LXR=e.saveData.LXR,a.REC_QJFS=e.saveData.QJFS,a.REC_TDLY=e.saveData.TDLY,a.REC_XZQ=e.saveData.XZQ,e.$refs.commonForm.form=Object(i["a"])({},a)})).catch((function(t){}))},getComponentName:function(t){var e=[];t&&t.length>0&&t.map((function(t,a){Window._.isEmpty(t.componentName)||e.push(t.componentName)})),this.componentNameArray=e,this.handleProcessData(JSON.parse(JSON.stringify(t)))},handleSubmit:function(){var t=[];if(this.componentNameArray.indexOf("CommonFormFinal")>-1&&this.$refs.commonForm.isEnableSubmit()){var e="CommonFormFinal";this.processData[this.componentNameArray.indexOf(e)].data=this.$refs.commonForm.getSubmitData()}if(this.componentNameArray.indexOf("CascaderSelect")>-1&&this.$refs.cascaderSelect.isEnableSubmit()){var a="CascaderSelect";this.processData[this.componentNameArray.indexOf(a)].data=this.$refs.cascaderSelect.getSubmitData()}if(this.componentNameArray.indexOf("FileTable")>-1&&this.$refs.fileTable.isEnableSubmit()){var s="FileTable";this.processData[this.componentNameArray.indexOf(s)].data=this.$refs.fileTable.getSubmitData()}if(this.componentNameArray.indexOf("OtherTable")>-1&&this.$refs.otherTable.isEnableSubmit()){var n="OtherTable";this.processData[this.componentNameArray.indexOf(n)].data=this.$refs.otherTable.getSubmitData()}t=JSON.parse(JSON.stringify(this.processData)),t.push({userid:this.user.userID,docunid:this.docunid}),t.push({rid:this.saveDataID}),this.processData[this.current]?t.push({currentComponentName:this.processData[this.current].componentName,currentComponentDesc:this.processData[this.current].componentDesc,current:this.current}):t.push({}),this.handleSubmitData(t)},handleSave:function(){var t=[];if(this.componentNameArray.indexOf("CommonFormFinal")>-1){var e="CommonFormFinal";this.processData[this.componentNameArray.indexOf(e)].data=this.$refs.commonForm.getSubmitData()}if(this.componentNameArray.indexOf("CascaderSelect")>-1){var a="CascaderSelect";this.processData[this.componentNameArray.indexOf(a)].data=this.$refs.cascaderSelect.getSubmitData()}if(this.componentNameArray.indexOf("FileTable")>-1){var s="FileTable";this.processData[this.componentNameArray.indexOf(s)].data=this.$refs.fileTable.getSubmitData()}if(this.componentNameArray.indexOf("OtherTable")>-1){var n="OtherTable";this.processData[this.componentNameArray.indexOf(n)].data=this.$refs.otherTable.getSubmitData()}t=JSON.parse(JSON.stringify(this.processData)),t.push({userid:this.user.userID,docunid:this.docunid}),t.push({rid:this.saveDataID}),this.processData[this.current]?t.push({currentComponentName:this.processData[this.current].componentName,currentComponentDesc:this.processData[this.current].componentDesc,current:this.current}):t.push({}),this.handleSaveData(t)},handleSaveData:function(t){var e=this,a=new FormData;a.append("data",JSON.stringify(t)),a.append("type",2),this.$WebApi.preBusiness["SubmitEntrust"](a).then((function(t){e.saveDataID=t,e.$message.success("暂存成功")})).catch((function(t){}))},handleSubmitData:function(t){var e=this,a=new FormData;a.append("data",JSON.stringify(t)),a.append("type",1),this.$WebApi.preBusiness["SubmitEntrust"](a).then((function(t){Object.prototype.hasOwnProperty.call(t,"code")?e.submitStatus="error":e.submitStatus="success"})).catch((function(t){e.submitStatus="error"}))},handleQueryMore:function(){this.$router.push({name:"businessProcess",params:{hasRefresh:!0}})},hadleRefresh:function(){var t=this;c["a"].reloadComponent(t)},handleCurrentStepOK:function(t){var e=this.current;1===t.num?this.current=++e:-1===t.num&&(this.current=--e),this.processData[e]&&(this.currentComponentName=this.processData[e].componentName,this.currentComponentDesc=this.processData[e].componentDesc)},submitAllData:function(){this.handleSubmit()},saveAllData:function(){this.handleSave()}})},D=f,b=(a("984a"),a("2877")),v=Object(b["a"])(D,s,n,!1,null,"516ee3dc",null);e["default"]=v.exports},d571:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"OtherTable"},[a("div",{staticClass:"content"},[a("p",[t._v(" "+t._s(t.WTS.WTSSM||"委托书说明:")+" "),a("a",{attrs:{href:t.WTS.WTSMB,download:"委托书模板"}},[t._v("下载委托书模板")])]),a("upload-table",{ref:"WTTable",attrs:{tableData:t.tableData,disabled:!1}})],1),a("div",{staticClass:"footer"},[a("div",{staticClass:"my-button"},[t._.isEmpty(t.permission.isTemporarySave)&&!0===t.permission.isTemporarySave?[a("a-button",{attrs:{type:"primary"},on:{click:t.saveCurrentData}},[t._v("暂存")])]:t._e(),a("a-button",{on:{click:function(e){return t.handleTableData(-1)}}},[t._v("上一步")]),a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleTableData(1)}}},[t._v(t._s(t.isLast?"提交申请":"下一步"))])],2)])])},n=[],i=a("4c6d"),o={name:"OtherTable",components:{"upload-table":i["default"]},props:{isLast:{default:!1,type:Boolean,required:!0},permission:{default:function(){},type:Object,required:!0},remoteData:{default:function(){},type:Object,required:!1}},data:function(){return{WTS:{WTSSM:"",WTSMB:""},tableData:{columns:[],hideColumns:[],rowsList:[]}}},computed:{},watch:{remoteData:{handler:function(t,e){t&&this.fillData2form(t)},immediate:!0,deep:!0}},created:function(){},mounted:function(){this.tableData=this.getTableData(),this.getCLWTS()},methods:{getTableData:function(){return{columns:[{label:"序号",key:"index",type:"text"},{label:"材料名称",key:"CLMC",type:"text"},{label:"备注说明",key:"BZSM",type:"text"},{label:"附件",key:"FJLIST",type:"text"}],hideColumns:["BZSM","FJLIST"],rowsList:[{index:"1",CLMC:"规划核实测量委托书",BZSM:"",FJLIST:[]},{index:"2",CLMC:"土地测绘委托书",BZSM:"",FJLIST:[]},{index:"3",CLMC:"房产实测委托书",BZSM:"",FJLIST:[]}]}},getCLWTS:function(){var t=this;this.$WebApi.preBusiness["GetEntrustTempWeb"]().then((function(e){t.WTS=e.rowsList[0].WTSMB})).catch((function(t){}))},handleTableData:function(t){1===t?this.isEnableSubmit()&&this.$emit("currentStepOK",{componentName:"OtherTable",num:t}):this.$emit("currentStepOK",{componentName:"OtherTable",num:t})},isEnableSubmit:function(){var t=!0;return this.$refs.WTTable.isAllSubmit()||(t=!1),t||this.$message.error("委托书填写失败"),t},getSubmitData:function(){return{files:this.$refs.WTTable.getSubmitData()}},saveCurrentData:function(){this.$emit("saveAllData")},fillData2form:function(t){Window._.isEmpty(t)||this.$set(this.tableData,"rowsList",t["REC_CLWTS"])}}},r=o,c=(a("2c2e"),a("2877")),l=Object(c["a"])(r,s,n,!1,null,"66171901",null);e["default"]=l.exports},fd19:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cascader-select"},[a("div",{staticClass:"content"},[t.reload?[t._l(t.saveData,(function(e,s){return[a("div",{key:s,staticClass:"my-items"},[a("div",{staticClass:"my-item"},[0===s?a("div",{staticClass:"item-header"},[t._v("测量事项")]):t._e(),a("a-cascader",{ref:"cascader",refInFor:!0,attrs:{allowClear:!1,options:t.options,fieldNames:{label:"title",value:"title",children:"rows"},"display-render":t.displayRender,"show-search":{filter:t.filter},"expand-trigger":"hover",placeholder:"请选择测量事项"},on:{change:function(e,a){return t.clsxChange(s,e,a)}},model:{value:t.saveData[s].clsx,callback:function(e){t.$set(t.saveData[s],"clsx",e)},expression:"saveData[index].clsx"}})],1),a("div",{staticClass:"my-item"},[0===s?a("div",{staticClass:"item-header"},[t._v("测绘单位")]):t._e(),a("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"请选择测绘公司","option-filter-prop":"children","filter-option":t.filterOption},on:{focus:t.handleFocus,blur:t.handleBlur,change:function(e){return t.compChange(s,e)}},model:{value:t.saveData[s].cldw,callback:function(e){t.$set(t.saveData[s],"cldw",e)},expression:"saveData[index].cldw"}},[t._l(t.selectData,(function(e,s){return[a("a-select-option",{key:s,attrs:{value:e.value}},[t._v(" "+t._s(e.value)+" ")])]}))],2)],1),a("div",{staticClass:"my-item"},[0===s?a("div",{staticClass:"item-header"},[t._v("联系人")]):t._e(),a("a-input",{attrs:{value:t.saveData[s].LXR||"-",disabled:""}},[a("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("div",{staticClass:"my-item"},[0===s?a("div",{staticClass:"item-header"},[t._v("联系电话")]):t._e(),a("a-input",{attrs:{value:t.saveData[s].LXDH||"-",disabled:""}},[a("a-icon",{attrs:{slot:"prefix",type:"phone"},slot:"prefix"})],1)],1),a("div",{staticClass:"my-item"},[0===s?a("div",{staticClass:"item-header"},[t._v("操作")]):t._e(),a("a-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteItem(s)}}},[t._v("删除")])],1)])]}))]:t._e(),a("div",{staticClass:"add-button"},[a("a-button",{attrs:{type:"primary"},on:{click:t.addRows}},[t._v("添加")])],1)],2),a("div",{staticClass:"footer"},[a("div",{staticClass:"my-button"},[t._.isEmpty(t.permission.isTemporarySave)&&!0===t.permission.isTemporarySave?[a("a-button",{attrs:{type:"primary"},on:{click:t.saveCurrentData}},[t._v("暂存")])]:t._e(),a("a-button",{on:{click:function(e){return t.handleTableData(-1)}}},[t._v("上一步")]),a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleTableData(1)}}},[t._v(t._s(t.isLast?"提交申请":"下一步"))])],2)])])},n=[],i=(a("c975"),a("d81d"),a("45fc"),a("a434"),{name:"CascaderSelect",components:{},props:{isLast:{default:!1,type:Boolean,required:!0},permission:{default:function(){},type:Object,required:!0},remoteData:{default:function(){},type:Object,required:!1}},data:function(){return{reload:!0,options:[{value:"zhejiang",label:"Zhejiang",children:[{value:"hangzhou",label:"Hangzhou",children:[{value:"xihu",label:"West Lake"}]}]},{value:"jiangsu",label:"Jiangsu",children:[{value:"nanjing",label:"Nanjing",children:[{value:"zhonghuamen",label:"Zhong Hua Men"}]}]}],selectData:[],selectedOptions:[],saveData:[{clsx:[],cldw:"",LXR:"",LXDH:""}],ischange:!1}},computed:{},watch:{remoteData:{handler:function(t,e){t&&this.fillData2form(t)},immediate:!0,deep:!0}},created:function(){},mounted:function(){this.GetMeasurementItems()},methods:{GetSurveyCompanyInfo:function(t,e){var a=this;this.$WebApi.busiProcess["GetSurveyCompanyInfo"]({chdw:t}).then((function(t){a.saveData[e].LXR=t.LXR,a.saveData[e].LXDH=t.LXDH})).catch((function(t){}))},GetMeasurementItems:function(){var t=this;this.$WebApi.preBusiness["GetMeasurementItems"]().then((function(e){var a=e.rowsList[0].CLSX,s=e.rowsList[0].CLDW;t.options=a,t.selectData=s})).catch((function(t){}))},clsxChange:function(t,e,a){this.ischange=!0,a[a.length-1].disabled=!0,this.selectedOptions[t]=a,this.$store.commit("CHANGE_SAVE_DATA",{saveData:this.saveData,ischange:this.ischange}),this.$store.commit("CHANGE_HANDLE_PRE_BUSNISS_STATE")},displayRender:function(t){var e=t.labels;return e[e.length-1]},filter:function(t,e){return e.some((function(e){return e.label.toLowerCase().indexOf(t.toLowerCase())>-1}))},compChange:function(t,e){this.GetSurveyCompanyInfo(e,t)},handleBlur:function(){},handleFocus:function(){},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},addRows:function(){this.ischange=!0,this.saveData.push({clsx:[],cldw:"",LXR:"",LXDH:""}),this.$store.commit("CHANGE_SAVE_DATA",{saveData:this.saveData,ischange:this.ischange}),this.$store.commit("CHANGE_HANDLE_PRE_BUSNISS_STATE")},deleteItem:function(t){var e=this;this.ischange=!0,this.selectedOptions[t]&&(this.selectedOptions[t].length>0?this.selectedOptions[t][this.selectedOptions[t].length-1].disabled=!1:this.selectedOptions[t]["disabled"]=!1,this.selectedOptions.splice(t,1));var a=JSON.parse(JSON.stringify(this.saveData));a.splice(t,1),this.saveData=[],this.saveData=a,this.$store.commit("CHANGE_SAVE_DATA",{saveData:this.saveData,ischange:this.ischange}),this.$store.commit("CHANGE_HANDLE_PRE_BUSNISS_STATE"),this.reload=!1,this.$nextTick((function(){e.reload=!0}))},handleTableData:function(t){1===t?(Window._.isEmpty(this.remoteData)||(this.$store.commit("CHANGE_SAVE_DATA",{saveData:this.saveData,ischange:this.ischange}),this.$store.commit("CHANGE_HANDLE_PRE_BUSNISS_STATE")),this.isEnableSubmit()&&this.$emit("currentStepOK",{componentName:"CascaderSelect",num:t})):this.$emit("currentStepOK",{componentName:"CascaderSelect",num:t})},isEnableSubmit:function(){var t=!0;return this.saveData&&this.saveData.length>0?this.saveData.map((function(e,a){Window._.isEmpty(e.cldw)&&(t=!1),e.clsx&&0===e.clsx.length&&(t=!1)})):t=!1,t||this.$message.error("测量事项填写失败"),t},getSubmitData:function(){var t=this.saveData;return{REC_CLSX:t}},saveCurrentData:function(){this.$emit("saveAllData")},fillData2form:function(t){var e=this;Window._.isEmpty(t)||(this.saveData=t["REC_CLSX"],t["REC_CLSX"].map((function(t,a){var s=t.clsx[t.clsx.length-1];e.addDisable2options(e.options,s)})))},addDisable2options:function(t,e){var a=this;t.map((function(t,s){t.title===e&&(t.disabled=!0,a.selectedOptions.push(t)),t.rows&&t.rows.length>0&&a.addDisable2options(t.rows,e)}))}}}),o=i,r=(a("2aef"),a("2877")),c=Object(r["a"])(o,s,n,!1,null,"3c391b36",null);e["default"]=c.exports}}]);